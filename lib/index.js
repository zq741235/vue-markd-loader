"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var fs=require("fs");var path=require("path");var hljs=require("highlight.js");var MarkdownIt=require("markdown-it");var templateCompiler=require("vue-template-compiler");var loaderUtils=require("loader-utils");var wrapper=function wrapper(content){return"\n<template>\n  <section v-html=\"content\" v-once />\n</template>\n<script>\nexport default {\n  created() {\n    this.content = decodeURIComponent(`".concat(encodeURIComponent(content),"`);\n  }\n};\n</script>\n")};var replaceVue=function replaceVue(source){var types=arguments.length>1&&arguments[1]!==undefined?arguments[1]:["template","script"];var descriptor=templateCompiler.parseComponent(source);var lang={template:"html",script:"javascript"};return types.map(function(type){return lang[type]&&"\n  ```".concat(lang[type],"\n  ").concat(descriptor[type].content,"\n  ``` \n  ")}).join("")};var replaceResults=function replaceResults(template,baseDir){var regexp=new RegExp("\\{\\{:([^:\\}]+)\\}\\}","g");return template.replace(regexp,function(match){match=match.substr(3,match.length-5);var _match$split=match.split("?"),_match$split2=_slicedToArray(_match$split,2),loadFile=_match$split2[0],_match$split2$=_match$split2[1],query=_match$split2$===void 0?"":_match$split2$;var source=fs.readFileSync(path.join(baseDir,loadFile),"utf-8").replace(/[\r\n]*$/,"");if(path.extname(loadFile)===".vue"){var _loaderUtils$parseQue=loaderUtils.parseQuery("?".concat(query)),type=_loaderUtils$parseQue.type;return replaceVue(source,typeof type==="string"?[type]:type)}return source})};var parser=new MarkdownIt({html:true,highlight:function highlight(str,lang){if(lang&&hljs.getLanguage(lang)){try{return"<pre class=\"hljs\"><code>"+hljs.highlight(lang,str,true).value+"</code></pre>"}catch(__){}}return"<pre class=\"hljs\"><code>"+MarkdownIt().utils.escapeHtml(str)+"</code></pre>"}});module.exports=function(source,options){this.cacheable&&this.cacheable();options=Object.assign({},{replaceFiles:false,wrapper:true},loaderUtils.getOptions(this)||options);if(options.replaceFiles&&typeof module!=="undefined"){source=replaceResults(source,process.cwd())}return options.wrapper?wrapper(parser.render(source)):parser.render(source)};